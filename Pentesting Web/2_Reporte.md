## Informe de Pentesting del Sitio Web delias tamales

Para ver la documentacion del pentesting, revisar: [Documentacion](1_Documentacion.md)
### I. Información General y Descubrimiento
#### 1. Dominio y Registrante: (Shodan & DNS Dumpster)
- **Dominio:** deliastamales.com
- **IP Principal:** 208.97.137.195
- **Organización/ISP:** New Dream Network, LLC / DreamHost 
- **Ubicación del Servidor:** Washington, Estados Unidos
##### Servidores DNS (NS): (DNS Dumpster)
https://www.google.com/search?q=ns1.dreamhost.com (162.159.26.14)
https://www.google.com/search?q=ns2.dreamhost.com (162.159.26.81)
https://www.google.com/search?q=ns3.dreamhost.com (162.159.27.94) 
##### Servidores de Correo (MX): (DNS Dumpster)
https://www.google.com/search?q=mx1.emailsrvr.com (108.166.43.1)
https://www.google.com/search?q=mx2.emailsrvr.com (184.106.54.2)
#### 2. Tecnologías Identificadas (Wappalyzer y Shodan):
- **Gestor de Contenido** (CMS): WordPress
- **Tienda Web:** WooCommerce 9.8.3
- **Red de Publicidad:** Google Ads
- **Procesadores de Pago:** jQuery Payment, SkyVerge
- **Analítica:** Google Analytics UA, Google Ads Conversion Tracking, Facebook Pixel
- **Tag Manager:** Google Tag Manager
- **SEO:** RankMath SEO
- **Lenguaje de Programación:** PHP
- **Caching:** WP Rocket
- **Seguridad:** reCAPTCHA
- **Bases de Datos:** MySQL
- **UI Frameworks:** ZURB Foundation
- **WordPress Plugins:** WP Rocket, WooCommerce, Order Delivery Date for WP E-commerce (Versión 12.4.1)
#### 3. Puertos Abiertos (Shodan):
- 22/TCP (OpenSSH)
- 25/TCP (Postfix smtpd)
- 80/TCP (HTTP)
- 123/UDP (NTP)
- 443/TCP (HTTPS)
### II. Hallazgos y Vulnerabilidades
#### 1. Exposición de Directorios Sensibles:
- El directorio /wp-includes/css/dist/edit-site está expuesto, permitiendo la navegación de archivos (Directory Listing).
-  La página de inicio de sesión de WordPress (wp-login.php) es directamente accesible públicamente.
#### 2. Vulnerabilidades Identificadas en Plugins de WordPress (WPScan):
-  Se identificaron 3 vulnerabilidades en el plugin "Order Delivery Date for WP E-commerce" versión 12.4.1.
- Admin+ Stored XSS: Cross-Site Scripting Almacenado con privilegios de administrador (CVE-2023-41859).
- Settings Update via CSRF: Actualización de configuración mediante Cross-Site Request Forgery (CVE-2023-41858).
- Unauthenticated Stored Cross-Site Scripting: Cross-Site Scripting Almacenado no autenticado (CVE-2024-0678).
#### 3. Vulnerabilidades de Seguridad Generales (OWASP ZAP - Spidering):
El análisis con ZAP Spider identificó 20 alertas, incluyendo:
- Ausencia de Tokens Anti-CSRF (en múltiples ubicaciones, incluyendo /fundraising/).
- Falta de Cabecera Content Security Policy (CSP).
- Falta de Cabecera Anti-Clickjacking (X-Frame-Options).
- Cookie Sin Flag HttpOnly.
- Cookie Sin Flag Secure.
- Divulgación de Información (por ejemplo, mensajes de error o versiones de librerías).
- Divulgación de errores de aplicación.
- Falta de cabecera X-Content-Type-Options.
### 4. Archivos PDF con Metadatos Expuestos (FOCA):
- Se encontró un archivo PDF (delias-menu.pdf) en /wp-content/uploads/2020/12/... con metadatos.
### III. Resumen de Riesgos
El sitio web de delias tamales.com presenta una serie de vulnerabilidades que, combinadas, podrían ser explotadas por un atacante. Las principales preocupaciones son:
- Exposición de información: Directorios listables y metadatos en documentos PDF.
- Riesgo de acceso no autorizado: Página de login expuesta y vulnerable a ataques de fuerza bruta.
- Vulnerabilidades de plugins: Múltiples XSS y CSRF en el plugin "Order Delivery Date for WP E-commerce" que podrían comprometer la integridad y disponibilidad del sitio, o el robo de datos de usuarios.
- Falta de cabeceras de seguridad: Aumenta el riesgo de ataques del lado del cliente como XSS y Clickjacking.
